<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Audit Log â€” Mizan Studio</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="mobile.css">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#060C18;color:#fff;display:flex;min-height:100vh}
.sidebar{width:240px;background:#0B1F3A;padding:24px 0;display:flex;flex-direction:column;position:fixed;height:100vh;z-index:10}
.sidebar .logo{padding:0 24px 24px;font-size:22px;font-weight:700;color:#D4AF37;border-bottom:1px solid rgba(212,175,55,.2)}
.sidebar nav{flex:1;padding:16px 0}
.sidebar nav a{display:flex;align-items:center;gap:10px;padding:12px 24px;color:rgba(255,255,255,.7);text-decoration:none;font-size:14px;transition:all .2s}
.sidebar nav a:hover,.sidebar nav a.active{color:#D4AF37;background:rgba(212,175,55,.08)}
.sidebar nav a.active{border-right:3px solid #D4AF37}
.sidebar .version{padding:16px 24px;font-size:12px;color:rgba(255,255,255,.3);border-top:1px solid rgba(212,175,55,.1)}
.main{margin-left:240px;flex:1;padding:40px}
.hamburger{display:none;position:fixed;top:16px;left:16px;z-index:20;background:#0B1F3A;border:1px solid rgba(212,175,55,.3);color:#D4AF37;font-size:24px;padding:8px 12px;border-radius:8px;cursor:pointer}
.overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:9}
h1{font-size:28px;margin-bottom:8px}
.subtitle{color:rgba(255,255,255,.5);margin-bottom:24px;font-size:14px}
.toolbar{display:flex;gap:12px;margin-bottom:24px;align-items:center;flex-wrap:wrap}
.btn{padding:10px 24px;background:#D4AF37;color:#0B1F3A;font-weight:600;border-radius:8px;border:none;cursor:pointer;font-size:14px}
.btn:hover{background:#c9a430}
.btn-outline{background:transparent;border:1px solid rgba(212,175,55,.4);color:#D4AF37}
.btn-outline:hover{background:rgba(212,175,55,.1)}
.filter{padding:8px 14px;background:rgba(255,255,255,.05);border:1px solid rgba(212,175,55,.2);border-radius:8px;color:#fff;font-size:14px;font-family:inherit}
.filter:focus{outline:none;border-color:#D4AF37}
.filter option{background:#0B1F3A}
table{width:100%;border-collapse:collapse}
th{text-align:left;padding:12px 16px;font-size:12px;text-transform:uppercase;color:rgba(255,255,255,.4);border-bottom:1px solid rgba(212,175,55,.1)}
td{padding:12px 16px;border-bottom:1px solid rgba(255,255,255,.05);font-size:13px}
tr:hover{background:rgba(212,175,55,.03)}
.badge{padding:4px 10px;border-radius:6px;font-size:12px;font-weight:600}
.badge-approved{background:rgba(52,211,153,.15);color:#34d399}
.badge-rejected{background:rgba(239,68,68,.15);color:#ef4444}
.badge-review{background:rgba(251,191,36,.15);color:#fbbf24}
.empty{text-align:center;padding:60px;color:rgba(255,255,255,.4)}
.empty .icon{font-size:48px;margin-bottom:12px}
.count{color:rgba(255,255,255,.4);font-size:13px}
.footer{text-align:center;padding:40px;font-size:12px;color:rgba(255,255,255,.25)}
</style>
</head>
<body>
<div class="hamburger" onclick="toggleSidebar()">â˜°</div>
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>
<div class="sidebar" id="sidebar">
  <div class="logo">âš–ï¸ Mizan Studio</div>
  <nav>
    <a href="index.html">ğŸ  Home</a>
    <a href="rules.html">ğŸ“‹ Rule Editor</a>
    <a href="decide.html">âš¡ Decision Tester</a>
    <a href="audit.html" class="active">ğŸ“Š Audit Log</a>
    <a href="agents.html">ğŸ¤– Agent Monitor</a>
    <a href="compliance.html"><span>ğŸ‡¦ğŸ‡ª</span> UAE Compliance</a>
    <a href="rag.html"><span>ğŸ“š</span> Knowledge Base</a>
    <a href="widget-demo.html"><span>ğŸ”Œ</span> Widget Demo</a>
    <a href="webhooks.html"><span>ğŸ”—</span> Webhooks</a>
    <a href="orchestration.html"><span>ğŸ”€</span> Multi-Agent</a>
    <a href="setup.html">âš™ï¸ Setup</a>
  </nav>
  <div class="version">ğŸ“¦ v1.1.0</div>
</div>
<div class="main">
  <h1>ğŸ“Š Audit Log</h1>
  <p class="subtitle">Complete decision history</p>
  <div class="toolbar">
    <button class="btn" onclick="loadDecisions()">ğŸ”„ Refresh</button>
    <select class="filter" id="filterAction" onchange="loadDecisions()">
      <option value="">All Actions</option>
      <option value="APPROVED">Approved</option>
      <option value="REJECTED">Rejected</option>
      <option value="REVIEW">Review</option>
    </select>
    <span class="count" id="count"></span>
  </div>
  <div id="tableArea"></div>
  <div class="footer">âš–ï¸ Mizan Framework SDK v1.1.0 | Built by mizanuae10x</div>
</div>
<script>
function toggleSidebar(){document.getElementById('sidebar').classList.toggle('open');document.getElementById('overlay').classList.toggle('show')}
async function loadDecisions(){
  const decisions=(await(await fetch('/api/decisions')).json()).reverse();
  const filter=document.getElementById('filterAction').value;
  const filtered=filter?decisions.filter(d=>d.decision===filter):decisions;
  document.getElementById('count').textContent=filtered.length+' entries'+(filter?' (filtered)':'');
  const el=document.getElementById('tableArea');
  if(!filtered.length){el.innerHTML='<div class="empty"><div class="icon">ğŸ“Š</div><p>No decisions recorded yet. Use the Decision Tester to create entries.</p></div>';return}
  el.innerHTML='<table><thead><tr><th>Time</th><th>Decision</th><th>Rule</th><th>Reason</th><th>Facts</th></tr></thead><tbody>'+filtered.map(d=>{
    const bc=d.decision==='APPROVED'?'badge-approved':d.decision==='REJECTED'?'badge-rejected':'badge-review';
    const t=d.timestamp?new Date(d.timestamp).toLocaleString():'â€”';
    const facts=d.facts?Object.entries(d.facts).map(([k,v])=>k+'='+v).join(', '):'â€”';
    return '<tr><td>'+t+'</td><td><span class="badge '+bc+'">'+d.decision+'</span></td><td>'+d.ruleName+'</td><td>'+d.reason+'</td><td style="max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="'+facts+'">'+facts+'</td></tr>'
  }).join('')+'</tbody></table>';
}
loadDecisions();
</script>
</body>
</html>
